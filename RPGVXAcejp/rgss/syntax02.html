<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>変数と定数</title>
<link href="../style.css" type="text/css" rel="stylesheet">
</head>
<body>

<h1>変数と定数</h1>
<ul>
<li><a href="#L000225">ローカル変数</a></li>
<li><a href="#L000226">インスタンス変数</a></li>
<li><a href="#L000227">クラス変数</a></li>
<li><a href="#L000228">グローバル変数</a></li>
<li><a href="#L000229">疑似変数</a></li>
<li><a href="#L000236">定数</a></li>
</ul>
<p>Ruby の変数と定数の種別は変数名の最初の一文字によって、
ローカル変数、
インスタンス変数、
クラス変数、
グローバル変数、
定数
のいずれかに区別されます。
通常の変数の二文字目以降は英数字または '_' ですが、組み込み変数の一部には
「'$' + 1 文字の記号」という変数があります (<a href="s_variables.html">組み
込み変数</a>を参照) 。</p>
<p>変数や定数は、特定のオブジェクトを指し示すものです。変数や定数への代入は、
それらが新しいオブジェクトを指すようにするための操作です。したがって、代入に
よりオブジェクトがコピーされて新しく作られることはありません。</p>

<h2><a name="L000225">ローカル変数</a></h2>
<p>例:</p>
<pre>
foobar
</pre>
<p>小文字または '_' で始まる識別子はローカル変数またはメソッド呼び出しです。</p>
<p>ローカル変数のスコープ (クラス、モジュール、メソッド定義の本体) における
小文字で始まる識別子への最初の代入は、そのスコープに属するローカル変数の宣言
になります。宣言されていない識別子の参照は引数の無いメソッド呼び出しとみな
されます。</p>

<h2><a name="L000226">インスタンス変数</a></h2>
<p>例:</p>
<pre>
@foobar
</pre>
<p>'@' で始まる変数はインスタンス変数であり、特定の
オブジェクトに所属しています。インスタンス変数はそのクラスま
たはサブクラスのメソッドから参照できます。初期化されていない
インスタンス変数を参照したときの値は nil です。</p>

<h2><a name="L000227">クラス変数</a></h2>
<p>例:</p>
<pre>
class Foo
  @@foo = 1
  def bar
    puts @@foo
  end
end
</pre>

<p><code>@@</code>で始まる変数はクラス変数です。クラス変数はクラス定義
の中で定義され、クラスの特異メソッド、インスタンスメソッドなどから参照／
代入ができます。</p>
<p>クラス変数と<a href="#L000236">定数</a>の違いは以下の通りです。</p>
<ul>
<li>再代入可能(定数は警告を出す)</li>
<li>クラスの外から直接参照できない(継承されたクラスからは参照／代入可能)</li>
</ul>

<h2><a name="L000228">グローバル変数</a></h2>
<p>例:</p>
<pre>
$foobar
</pre>
<p>'$' で始まる変数はグローバル変数で、プログラムの
どこからでも参照できます (その分、利用には注意が必要です) 。
グローバル変数には宣言は必要ありません。
初期化されていないグローバル変数を参照したときの値は
nil です。</p>

<h2><a name="L000229">疑似変数</a></h2>
<p>通常の変数以外に、疑似変数と呼ばれる特殊な変数があります。</p>
<dl>
<dt>self</dt>
<dd>
<p>現在のメソッドの実行主体。</p>
</dd>
<dt>nil</dt>
<dd>
<p><a href="sc_nilclass.html">NilClass</a> クラスの唯一の
インスタンス。偽を表します。</p>
</dd>
<dt>true</dt>
<dd>
<p><a href="sc_trueclass.html">TrueClass</a> クラスの唯一の
インスタンス。真を表します。</p>
</dd>
<dt>false</dt>
<dd>
<p><a href="sc_falseclass.html">FalseClass</a> クラスの唯一の
インスタンス。偽を表します。</p>
</dd>
</dl>
<p>疑似変数の値を変更することはできません。
擬似変数へ代入すると文法エラーになります。</p>

<h2><a name="L000236">定数</a></h2>
<p>例:</p>
<pre>
FOOBAR
</pre>
<p>アルファベット大文字で始まる識別子は定数です。
定数の定義 (と初期化) は代入によって行われますが、メソッドの中では定義
できません。定義されていない定数にアクセスすると例外
<a href="s_exceptions.html#NameError">NameError</a> が発生します。</p>
<p>定数はその定数が定義されたクラス / モジュールの中、クラスを継承している
クラス、モジュールをインクルードしているクラスまたはモジュールから参照する
ことができます。定数を外部から参照するためには '::' 演算子を用います。</p>
<pre>
class Foo
  FOO = 'FOO'
end

class Bar &lt; Foo
  p FOO             # =&gt; &quot;FOO&quot;
end

p Foo::FOO          # =&gt; &quot;FOO&quot;
</pre>
<p>また、クラスやモジュールの名前も定数と同じ扱いになります。</p>

<h6></h6>
</body>
</html>
